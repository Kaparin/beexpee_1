/// <reference types="node" />
import { IncomingMessage } from 'http';
import type { ConnectOptions } from 'mongoose';
import { CorsOptions } from 'cors';
import type { GraphQLSchema } from 'graphql';
import type { Config } from 'apollo-server-express';
import type { KeystoneContext } from '..';
import { CreateContext } from '../core';
import type { BaseKeystone } from '../base';
import { SessionStrategy } from '../session';
import type { MaybePromise } from '../utils';
import type { ListSchemaConfig, ListConfig, BaseFields, FieldType, FieldConfig, MaybeSessionFunction, MaybeItemFunction } from './lists';
import type { ListAccessControl, FieldAccessControl } from './access-control';
import type { ListHooks } from './hooks';
export declare type KeystoneConfig = {
    lists: ListSchemaConfig;
    db: DatabaseConfig;
    ui?: AdminUIConfig;
    server?: ServerConfig;
    session?: () => SessionStrategy<any>;
    graphql?: GraphQLConfig;
    extendGraphqlSchema?: ExtendGraphqlSchema;
    /** Experimental config options */
    experimental?: {
        /** Enables nextjs graphql api route mode */
        enableNextJsGraphqlApiEndpoint?: boolean;
        /** Enable Prisma+SQLite support */
        prismaSqlite?: boolean;
    };
};
export type { ListSchemaConfig, ListConfig, BaseFields, FieldType, FieldConfig, MaybeSessionFunction, MaybeItemFunction, };
export declare type DatabaseCommon = {
    url: string;
    onConnect?: (args: KeystoneContext) => Promise<void>;
};
export declare type DatabaseConfig = DatabaseCommon & ({
    adapter: 'prisma_postgresql';
    useMigrations?: boolean;
    enableLogging?: boolean;
    getPrismaPath?: (arg: {
        prismaSchema: any;
    }) => string;
    getDbSchemaName?: (arg: {
        prismaSchema: any;
    }) => string;
} | {
    adapter: 'prisma_sqlite';
    useMigrations?: boolean;
    enableLogging?: boolean;
    getPrismaPath?: (arg: {
        prismaSchema: any;
    }) => string;
} | {
    adapter: 'knex';
    dropDatabase?: boolean;
    schemaName?: string;
} | {
    adapter: 'mongoose';
    mongooseOptions?: {
        mongoUri?: string;
    } & ConnectOptions;
});
export declare type AdminUIConfig = {
    /** Completely disables the Admin UI */
    isDisabled?: boolean;
    /** Enables certain functionality in the Admin UI that expects the session to be an item */
    enableSessionItem?: boolean;
    /** A function that can be run to validate that the current session should have access to the Admin UI */
    isAccessAllowed?: (context: KeystoneContext) => MaybePromise<boolean>;
    /** An array of page routes that can be accessed without passing the isAccessAllowed check */
    publicPages?: string[];
    /** The basePath for the Admin UI App */
    getAdditionalFiles?: ((config: KeystoneConfig) => MaybePromise<AdminFileToWrite[]>)[];
    pageMiddleware?: (args: {
        req: IncomingMessage;
        session: any;
        isValidSession: boolean;
        createContext: CreateContext;
    }) => MaybePromise<{
        kind: 'redirect';
        to: string;
    } | void>;
};
export declare type AdminFileToWrite = {
    mode: 'write';
    src: string;
    outputPath: string;
} | {
    mode: 'copy';
    inputPath: string;
    outputPath: string;
};
export declare type ServerConfig = {
    /** Configuration options for the cors middleware. Set to `true` to use core Keystone defaults */
    cors?: CorsOptions | true;
    /** Port number to start the server on. Defaults to process.env.PORT || 3000 */
    port?: number;
};
export declare type GraphQLConfig = {
    queryLimits?: {
        maxTotalResults?: number;
    };
    /**
     *  Additional options to pass into the ApolloServer constructor.
     *  @see https://www.apollographql.com/docs/apollo-server/api/apollo-server/#constructor
     */
    apolloConfig?: Config;
};
export declare type ExtendGraphqlSchema = (schema: GraphQLSchema, keystone: BaseKeystone) => GraphQLSchema;
export type { ListHooks, ListAccessControl, FieldAccessControl };
